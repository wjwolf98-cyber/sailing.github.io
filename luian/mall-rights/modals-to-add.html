<!-- ========================================== -->
<!-- 将以下模态框代码添加到 index.html 的通知弹窗后面 -->
<!-- 在 <script src="../script.js"></script> 之前 -->
<!-- ========================================== -->

    <!-- 维权详情模态框 -->
    <div class="modal" id="rightsDetailModal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>维权详情 - RP20240115000001</h3>
                <button class="btn-close" onclick="closeModal('rightsDetailModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="padding: 24px; max-height: 70vh; overflow-y: auto;">
                <!-- 基本信息 -->
                <div style="margin-bottom: 24px;">
                    <h4 style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-color);">基本信息</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">维权编号</div>
                            <div style="font-weight: 600;">RP20240115000001</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">申请人</div>
                            <div style="font-weight: 600;">张三 (138****8000)</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">提交时间</div>
                            <div style="font-weight: 600;">2024-01-15 08:30</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">维权类型</div>
                            <div><span class="badge-danger">假冒伪劣</span></div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">当前状态</div>
                            <div><span class="badge-warning">调查中</span></div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">维权金额</div>
                            <div style="font-weight: 600; color: var(--danger-color);">¥799.00</div>
                        </div>
                    </div>
                </div>
                
                <!-- 订单信息 -->
                <div style="margin-bottom: 24px;">
                    <h4 style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-color);">订单信息</h4>
                    <div style="display: flex; gap: 15px; padding: 15px; background: var(--bg-color); border-radius: 8px;">
                        <img src="https://via.placeholder.com/80" style="width: 80px; height: 80px; border-radius: 8px;">
                        <div style="flex: 1;">
                            <div style="font-weight: 600; margin-bottom: 5px;">某品牌运动鞋 男款 42码</div>
                            <div style="color: var(--danger-color); font-weight: 600; margin-bottom: 5px;">¥599.00 × 1</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">订单号：OD20240110000001</div>
                            <div style="font-size: 13px; color: var(--text-secondary);">购买时间：2024-01-10 14:30</div>
                        </div>
                    </div>
                </div>
                
                <!-- 问题描述 -->
                <div style="margin-bottom: 24px;">
                    <h4 style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-color);">问题描述</h4>
                    <div style="padding: 15px; background: var(--bg-color); border-radius: 8px;">
                        <div style="font-weight: 600; margin-bottom: 10px;">购买到假冒商品，要求退货退款</div>
                        <div style="line-height: 1.8; color: var(--text-secondary);">
                            我于2024年1月10日在商城购买了某品牌运动鞋，收到后发现商标模糊不清，材质与正品差异明显，鞋底做工粗糙，怀疑是假冒商品。我对比了官网正品图片，发现多处不符...
                        </div>
                    </div>
                </div>
                
                <!-- 证据材料 -->
                <div style="margin-bottom: 24px;">
                    <h4 style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-color);">证据材料 (3)</h4>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                        <div style="aspect-ratio: 1; border-radius: 8px; overflow: hidden; cursor: pointer;">
                            <img src="https://via.placeholder.com/150" style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                        <div style="aspect-ratio: 1; border-radius: 8px; overflow: hidden; cursor: pointer;">
                            <img src="https://via.placeholder.com/150" style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                        <div style="aspect-ratio: 1; border-radius: 8px; overflow: hidden; cursor: pointer;">
                            <img src="https://via.placeholder.com/150" style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                    </div>
                </div>
                
                <!-- 处理流程 -->
                <div style="margin-bottom: 24px;">
                    <h4 style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-color);">处理流程</h4>
                    <div style="position: relative; padding-left: 30px;">
                        <!-- 时间轴线 -->
                        <div style="position: absolute; left: 9px; top: 0; bottom: 0; width: 2px; background: var(--border-color);"></div>
                        
                        <!-- 流程节点 -->
                        <div style="position: relative; margin-bottom: 20px;">
                            <div style="position: absolute; left: -30px; width: 20px; height: 20px; border-radius: 50%; background: var(--success-color); border: 3px solid white; box-shadow: 0 0 0 2px var(--success-color);"></div>
                            <div style="padding: 15px; background: var(--bg-color); border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">提交申请</span>
                                    <span style="font-size: 13px; color: var(--text-secondary);">2024-01-15 08:30</span>
                                </div>
                                <div style="font-size: 14px; color: var(--text-secondary);">消费者张三提交维权申请</div>
                            </div>
                        </div>
                        
                        <div style="position: relative; margin-bottom: 20px;">
                            <div style="position: absolute; left: -30px; width: 20px; height: 20px; border-radius: 50%; background: var(--success-color); border: 3px solid white; box-shadow: 0 0 0 2px var(--success-color);"></div>
                            <div style="padding: 15px; background: var(--bg-color); border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">客服受理</span>
                                    <span style="font-size: 13px; color: var(--text-secondary);">2024-01-15 09:00</span>
                                </div>
                                <div style="font-size: 14px; color: var(--text-secondary);">客服李四已受理，初步判断为假冒商品</div>
                                <div style="font-size: 13px; color: var(--text-secondary); margin-top: 5px;">处理人：客服李四</div>
                            </div>
                        </div>
                        
                        <div style="position: relative; margin-bottom: 20px;">
                            <div style="position: absolute; left: -30px; width: 20px; height: 20px; border-radius: 50%; background: var(--primary-color); border: 3px solid white; box-shadow: 0 0 0 2px var(--primary-color);"></div>
                            <div style="padding: 15px; background: #e6f7ff; border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">现场核查</span>
                                    <span style="font-size: 13px; color: var(--text-secondary);">进行中...</span>
                                </div>
                                <div style="font-size: 14px; color: var(--text-secondary);">已分派给巡查员王五进行现场核查</div>
                                <div style="font-size: 13px; color: var(--text-secondary); margin-top: 5px;">处理人：巡查员王五</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 操作按钮 -->
                <div style="display: flex; gap: 10px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                    <button class="btn-primary" onclick="showModal('acceptModal')">
                        <i class="fas fa-check"></i> 受理
                    </button>
                    <button class="btn-primary" onclick="showModal('assignModal')">
                        <i class="fas fa-user-plus"></i> 分派
                    </button>
                    <button class="btn-primary" onclick="showModal('processModal')">
                        <i class="fas fa-edit"></i> 添加处理记录
                    </button>
                    <button class="btn-outline" onclick="showModal('closeModal')">
                        <i class="fas fa-check-circle"></i> 标记解决
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 受理模态框 -->
    <div class="modal" id="acceptModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>受理维权申请</h3>
                <button class="btn-close" onclick="closeModal('acceptModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="padding: 24px;">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">维权编号</label>
                    <input type="text" value="RP20240115000001" disabled style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-color);">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;"><span style="color: var(--danger-color);">*</span> 初步判断</label>
                    <select style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 4px;">
                        <option>请选择</option>
                        <option selected>确认为假冒商品</option>
                        <option>确认为质量问题</option>
                        <option>确认为虚假宣传</option>
                        <option>确认为服务纠纷</option>
                        <option>需进一步核查</option>
                        <option>不予受理</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;"><span style="color: var(--danger-color);">*</span> 受理意见</label>
                    <textarea placeholder="请输入受理意见..." style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 4px; min-height: 100px; resize: vertical;">经初步审核，该维权申请材料齐全，问题描述清晰，证据充分。初步判断为假冒商品，建议分派给巡查员进行现场核查。</textarea>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">分派给</label>
                    <select style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 4px;">
                        <option>请选择处理人</option>
                        <option selected>巡查员王五</option>
                        <option>巡查员赵六</option>
                        <option>专家李专家</option>
                        <option>律师张律师</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 24px;">
                    <button class="btn-outline" style="flex: 1;" onclick="closeModal('acceptModal')">取消</button>
                    <button class="btn-primary" style="flex: 1;" onclick="submitAccept()">确认受理</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 分派模态框 -->
    <div class="modal" id="assignModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>分派任务</h3>
                <button class="btn-close" onclick="closeModal('assignModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="padding: 24px;">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;"><span style="color: var(--danger-color);">*</span> 分派部门</label>
                    <select id="deptSelect" onchange="updateHandlerList()" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 4px;">
                        <option>请选择部门</option>
                        <option value="inspection">巡查部</option>
                        <option value="expert">专家组</option>
                        <option value="legal">法务部</option>
                        <option value="mediation">调解部</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;"><span style="color: var(--danger-color);">*</span> 分派给</label>
                    <select id="handlerSelect" style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 4px;">
                        <option>请先选择部门</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">优先级</label>
                    <div style="display: flex; gap: 10px;">
                        <label style="flex: 1; padding: 10px; border: 2px solid var(--border-color); border-radius: 4px; text-align: center; cursor: pointer;">
                            <input type="radio" name="priority" value="LOW"> 低
                        </label>
                        <label style="flex: 1; padding: 10px; border: 2px solid var(--border-color); border-radius: 4px; text-align: center; cursor: pointer;">
                            <input type="radio" name="priority" value="NORMAL" checked> 普通
                        </label>
                        <label style="flex: 1; padding: 10px; border: 2px solid var(--border-color); border-radius: 4px; text-align: center; cursor: pointer;">
                            <input type="radio" name="priority" value="HIGH"> 高
                        </label>
                        <label style="flex: 1; padding: 10px; border: 2px solid var(--border-color); border-radius: 4px; text-align: center; cursor: pointer;">
                            <input type="radio" name="priority" value="URGENT"> 紧急
                        </label>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;"><span style="color: var(--danger-color);">*</span> 分派说明</label>
                    <textarea placeholder="请输入分派说明..." style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 4px; min-height: 100px; resize: vertical;">请尽快进行现场核查，重点关注商标、材质、做工等方面，并拍照取证。</textarea>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 24px;">
                    <button class="btn-outline" style="flex: 1;" onclick="closeModal('assignModal')">取消</button>
                    <button class="btn-primary" style="flex: 1;" onclick="submitAssign()">确认分派</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 处理记录模态框 -->
    <div class="modal" id="processModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>添加处理记录</h3>
                <button class="btn-close" onclick="closeModal('processModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="padding: 24px;">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;"><span style="color: var(--danger-color);">*</span> 处理类型</label>
                    <select style="width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 4px;">
                        <option>请选择</option>
                        <option>现场核查</option>
                        <option>专家鉴定</option>
                        <option>调解协商</option>
                        <option>法律咨询</option>
                        <option>其他</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;"><span style="color: var(--danger-color);">*</span> 处理内容</label>
                    <textarea placeholder="请详细描述处理过程和发现的问题..." style="width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 4px; min-height: 120px; resize: vertical;"></textarea>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">上传附件</label>
                    <div style="border: 2px dashed var(--border-color); border-radius: 8px; padding: 30px; text-align: center; cursor: pointer;" onclick="alert('上传附件功能')">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 36px; color: var(--text-secondary); margin-bottom: 10px;"></i>
                        <div style="color: var(--text-secondary);">点击上传或拖拽文件到此处</div>
                        <div style="font-size: 12px; color: var(--text-secondary); margin-top: 5px;">支持图片、文档、视频</div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 24px;">
                    <button class="btn-outline" style="flex: 1;" onclick="closeModal('processModal')">取消</button>
                    <button class="btn-primary" style="flex: 1;" onclick="submitProcess()">提交</button>
                </div>
            </div>
        </div>
    </div>

<!-- ========================================== -->
<!-- JavaScript 函数（添加到现有 script 标签中） -->
<!-- ========================================== -->

<script>
// 显示维权详情
function showRightsDetail(rpNo) {
    showModal('rightsDetailModal');
}

// 提交受理
function submitAccept() {
    alert('✅ 受理成功！\n\n维权申请已受理，已分派给巡查员王五');
    closeModal('acceptModal');
    closeModal('rightsDetailModal');
}

// 提交分派
function submitAssign() {
    const dept = document.getElementById('deptSelect').value;
    const handler = document.getElementById('handlerSelect').value;
    
    if (!dept || !handler) {
        alert('请选择部门和处理人');
        return;
    }
    
    alert('✅ 分派成功！\n\n任务已分派给相关人员');
    closeModal('assignModal');
}

// 更新处理人列表
function updateHandlerList() {
    const dept = document.getElementById('deptSelect').value;
    const handlerSelect = document.getElementById('handlerSelect');
    
    const handlers = {
        'inspection': [
            { value: 'inspector1', label: '巡查员王五' },
            { value: 'inspector2', label: '巡查员赵六' }
        ],
        'expert': [
            { value: 'expert1', label: '专家李专家' },
            { value: 'expert2', label: '专家周专家' }
        ],
        'legal': [
            { value: 'lawyer1', label: '律师张律师' },
            { value: 'lawyer2', label: '律师刘律师' }
        ],
        'mediation': [
            { value: 'mediator1', label: '调解员孙调解' },
            { value: 'mediator2', label: '调解员钱调解' }
        ]
    };
    
    handlerSelect.innerHTML = '<option>请选择处理人</option>';
    
    if (handlers[dept]) {
        handlers[dept].forEach(h => {
            const option = document.createElement('option');
            option.value = h.value;
            option.textContent = h.label;
            handlerSelect.appendChild(option);
        });
    }
}

// 提交处理记录
function submitProcess() {
    alert('✅ 处理记录已添加！');
    closeModal('processModal');
}
</script>
